.TH AIFO-CODER 1 "2025-08-23" "aifo-coder" "User Commands"
.SH NAME
aifo-coder \- secure Docker-based launcher for coding assistant agents
.SH SYNOPSIS
.B aifo-coder
.RB [ OPTIONS ]
.I COMMAND
.RI [ " -- " "AGENT-OPTIONS" ]
.P
.B aifo-coder
.RB [ \-h | \-\-help ]
.P
.B aifo-coder
.RB [ \-V | \-\-version ]
.SH DESCRIPTION
.B aifo-coder
is a small Rust CLI that launches developer "agent" tools inside Docker
containers with safe defaults. It assembles a
.B docker run
command with:
.IP \[bu] 2
TTY detection for interactive sessions.
.IP \[bu]
UID:GID mapping to the invoking user.
.IP \[bu]
Conservative environment pass\-through.
.IP \[bu]
Minimal host mounts.
.IP \[bu]
An AppArmor profile on hosts that support it.
.P
To prevent concurrent runs that might contend for the same workspace,
.B aifo-coder
creates a lock file at a candidate location (see
.BR FILES ).
.P
Different agents are selected via the positional
.I COMMAND
subcommand. Additional options after
.B --
.RI ( AGENT-OPTIONS )
are passed through unchanged to the agent process inside the container.
.SH AGENTS
The set of available agents is build\-dependent. Common agents include:
.TP
.B codex
Run the OpenAI Codex\-based CLI.
.TP
.B crush
Run the Charmbracelet Crush TUI.
.P
Consult the installed documentation for agent\-specific details.
.SH OPTIONS
.TP
.BR \-\-image =IMAGE
Override the Docker image reference used for the selected agent. If unset,
the image is derived from
.BR AIFO_CODER_IMAGE ,
.BR AIFO_CODER_IMAGE_PREFIX " and " AIFO_CODER_IMAGE_TAG
(see ENVIRONMENT).
.TP
.BR \-h ", " \-\-help
Print help and exit.
.TP
.BR \-V ", " \-\-version
Print version information and exit.
.SH ENVIRONMENT
.TP
.B AIFO_CODER_IMAGE
If set to a non\-empty string, use this Docker image reference for all agents,
overriding per\-agent defaults and \-\-image.
.TP
.B AIFO_CODER_IMAGE_PREFIX
Prefix used to construct default image references when
.BR AIFO_CODER_IMAGE
is not set. Defaults to
.BR aifo\-coder .
.TP
.B AIFO_CODER_IMAGE_TAG
Tag used to construct default image references when
.BR AIFO_CODER_IMAGE
is not set. Defaults to
.BR latest .
.TP
.B AIFO_CODER_REGISTRY_PREFIX
Override the Docker registry prefix for image pulls. If unset, the launcher tests connectivity to
https://repository.migros.net
and uses
.B repository.migros.net/
when reachable; otherwise no registry prefix is used and Docker Hub is assumed. Set to an empty string to force Docker Hub.
.TP
.B AIFO_CODER_APPARMOR_PROFILE
If set to a non\-empty string on Linux hosts whose Docker daemon reports
AppArmor support, this value is applied as the container's AppArmor profile
(via
.BR \-\-security\-opt " " apparmor=PROFILE ).
When unset, the launcher chooses a sensible default (a custom profile on
native Linux; docker\-default on macOS/Windows Docker\-in\-VM).
.TP
.B XDG_RUNTIME_DIR
Considered as a higher\-priority location for the lock file. If set to a
non\-empty directory, the lock may be created at
.BR $XDG_RUNTIME_DIR/aifo\-coder.lock .
.TP
.B HOME
Used for default paths and may influence host mounts inside the container.
.TP
.B GNUPGHOME
May be passed through to the container environment to enable GPG operations,
depending on the agent and launcher defaults.
.SH SECURITY
On Linux hosts with AppArmor support, the launcher attempts to run agents
under a constrained AppArmor profile to reduce kernel attack surface and
limit syscalls and capabilities. An AppArmor profile may be installed
system\-wide by your distribution or administrator. When AppArmor
is unavailable (e.g., macOS Docker\-in\-VM) the launcher falls back to the
Docker default profile.
.SH FILES
.TP
.B ~/.aifo\-coder.lock
Per\-user lock file candidate.
.TP
.B $XDG_RUNTIME_DIR/aifo\-coder.lock
Per\-session lock file candidate when
.B XDG_RUNTIME_DIR
is set.
.TP
.B /tmp/aifo\-coder.lock
Fallback lock file candidate.
.TP
.B /etc/apparmor.d/aifo\-coder
System AppArmor profile (if installed) used to constrain containerized agents.
.SH EXIT STATUS
The launcher propagates the exit status of the agent process running inside
the container. A non\-zero exit code indicates failure reported by the agent
or the container runtime.
.SH EXAMPLES
.TP
Run the Codex agent with default image:
.P
.nf
aifo\-coder codex \-\- \-\-help
.fi
.TP
Run the Crush agent with a custom image:
.P
.nf
aifo\-coder \-\-image aifo\-coder\-crush:nightly crush
.fi
.SH TOOLCHAIN
The toolchain subcommand launches a sidecar container for a language toolchain
and executes the specified command within it.
.TP
.B aifo-coder toolchain
.I kind
\-\-
.I args...
.P
Supported kinds:
.B rust ,
.B node ,
.B typescript
(alias of node),
.B python ,
.B c\-cpp ,
.B go .
.P
Examples:
.P
.nf
aifo\-coder toolchain rust \-\- cargo \-\-version
aifo\-coder toolchain node \-\- npx \-\-version
aifo\-coder toolchain python \-\- python \-m pip \-\-version
.fi

.SH SEE ALSO
.BR docker (1),
.BR apparmor (7),
.BR sh (1)
.SH AUTHORS
Amir Guindehi <amir.guindehi@mgb.ch> and contributors.
.SH COPYRIGHT
Copyright (c) the aifo\-coder authors.
License: Apache License 2.0. See
.BR /usr/share/licenses/aifo\-coder/LICENSE
or https://www.apache.org/licenses/LICENSE-2.0.
