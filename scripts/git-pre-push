#!/usr/bin/env bash
set -euo pipefail

repo_root="$(git rev-parse --show-toplevel 2>/dev/null || true)"
if [ -z "$repo_root" ]; then
  echo "git-pre-push: not inside a git repository; skipping." >&2
  exit 0
fi

cd "$repo_root"

echo "git-pre-push: running make lint ..."
make lint

echo "git-pre-push: running make check ..."
make check

echo "git-pre-push: ok"
